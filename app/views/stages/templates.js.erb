<% if @template.valid? && !@template.new_record? -%>
  $(".overlay").remove();
  $(".drawer").slideUp("fast");
<% else %>
  $("form.entry").find(".error_messages").remove();
  $(".field_with_errors input").unwrap();

  $("form.entry").prepend("<%= escape_javascript(render("shared/error_messages", :target => @template)) %>");
  <% @template.errors.each do |attr, msg| -%>
    $("#template_<%= attr %>").wrap('<div class="field_with_errors" />');
  <% end -%>
<% end -%>
